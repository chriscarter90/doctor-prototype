<h3>Course-week Selection</h3>

<%= form_tag update_course_weeks_path(@year), :method => :put do %>
  <table class='table'>
    <tr>
      <th rowspan="2">
        Course
      </th>
      <% @terms.each do |t| %>
        <th colspan="<%= t.weeks.size %>">
          <%= "Term #{t.no}" %>
        </th>
      <% end %>
    </tr>
    <tr>
      <% @terms.each do |t| %>
        <% t.weeks.each do |w| %>
          <th>
            <%= w.no %>
          </th>
        <% end %>
      <% end %>
    </tr>

    <% @courses.each do |c| %>
      <tr>
        <td>
          <%= "#{c.code} - #{c.title}" %>
        </td>
        <% @terms.each do |t| %>
          <% if c.taught_in_term?(t) %>
            <% t.weeks.each do |w| %>
              <td>
                <%= check_box_tag "course_weeks[#{c.code}][#{t.no}][]", w.no, CourseWeek.exists?(:lecture_course_id => c, :week_id => w), :id => "#{c.code.parameterize}-#{t.no}-#{w.no}" %>
              </td>
            <% end %>
          <% end %>
        <% end %>
      </tr>
    <% end %>
  </table>

  <%= submit_tag "Submit", :class => "btn btn-primary" %>
<% end %>
